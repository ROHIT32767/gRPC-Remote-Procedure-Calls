syntax = "proto3";

service PaymentGateway {
  rpc Login(LoginRequest) returns (LoginResponse);     // Authentication
  rpc ProcessPayment(PaymentRequest) returns (PaymentResponse); // 2PC payment
  rpc GetBalance(BalanceRequest) returns (BalanceResponse); // Get account balance
}

service Bank {
  rpc Prepare(PrepareRequest) returns (Vote);         // 2PC Phase 1
  rpc Commit(CommitRequest) returns (Ack);            // 2PC Phase 2
  rpc Abort(AbortRequest) returns (Ack);
  rpc GetBalance(BalanceRequest) returns (BalanceResponse); // Get account balance
}

// ---------- Messages ----------
message LoginRequest {
  string username = 1;
  string password = 2;
}

message LoginResponse {
  string token = 1;
}

message PaymentRequest {
  string transaction_id = 1;
  string from_account = 2;
  string to_account = 3;
  double amount = 4;
}

message PaymentResponse {
  bool success = 1;
}

message PrepareRequest {
  string transaction_id = 1;
  string from_account = 2;
  string to_account = 3;
  double amount = 4;
}

message Vote {
  bool vote = 1;
}

message CommitRequest {
  string transaction_id = 1;
}

message AbortRequest {
  string transaction_id = 1;
}

message Ack {
  bool success = 1;
}

// New messages for GetBalance
message BalanceRequest {
  string account_number = 1; // Account number to fetch balance for
}

message BalanceResponse {
  double balance = 1; // Balance of the account
}